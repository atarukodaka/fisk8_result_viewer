keys = [:sid, :competition_name, :date, :season, :ranking, :skater_name, :nation,
        :number, :name, :factor, :judges, :value]

csv << keys


collection.each do |item|
  csv << [item.score.sid, item.score.competition.name, item.score.date, item.score.competition.season,
          item.score.ranking, item.score.skater.name, item.score.skater.nation] +
    ([:number, :name, :factor, :judges, :value].map {|k| item[k]})
end
